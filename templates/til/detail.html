
{% extends "base.html" %}

{% block title %}
  {{ til.title }} | Today I Learned | {{ site_name }}
{% endblock %}

{% block meta_description %}
  {{ til.body_text|truncatewords:50 }}
{% endblock %}

{% block og_title %}
  {{ til.title }}
{% endblock %}

{% block og_description %}
  {{ til.body_text|truncatewords:50 }}
{% endblock %}

{% block og_type %}
  article
{% endblock %}

{% block og_url %}
  {{ request.build_absolute_uri }}
{% endblock %}

{% block og_image %}
{% if til.get_image_url %}
<meta property="og:image" content="{{ request.scheme }}://{{ request.get_host }}{{ til.get_image_url }}" />
{% else %}
{{ block.super }}
{% endif %}
{% endblock %}

{% block twitter_title %}
  {{ til.title }}
{% endblock %}

{% block twitter_description %}
  {{ til.body_text|truncatewords:50 }}
{% endblock %}

{% block twitter_image %}
  {% if til.get_image_url %}
    <meta name="twitter:image" content="{{ request.scheme }}://{{ request.get_host }}{{ til.get_image_url }}" />
  {% else %}
    {{ block.super }}
  {% endif %}
{% endblock %}

{% block extra_head %}
<!-- Structured Data (JSON-LD) for SEO -->
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "{{ til.title|escapejs }}",
  "description": "{{ til.body_text|truncatewords:50|escapejs }}",
  "datePublished": "{{ til.created|date:'c' }}",
  "author": {
    "@type": "Person",
    "name": "{% if til.author %}{{ til.author.get_full_name|default:til.author.username }}{% else %}{{ site_name }}{% endif %}"
  },
  "publisher": {
    "@type": "Organization",
    "name": "{{ site_name }}",
    "logo": {
      "@type": "ImageObject",
      "url": "{{ request.scheme }}://{{ request.get_host }}{% load static %}{% static 'images/logo.png' %}"
    }
  },
  {% if til.get_image_url %}"image": "{{ request.scheme }}://{{ request.get_host }}{{ til.get_image_url }}",{% endif %}
  "url": "{{ request.build_absolute_uri }}",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "{{ request.build_absolute_uri }}"
  }{% if til.tags.exists %},
  "keywords": "{% for tag in til.tags.all %}{{ tag.name }}{% if not forloop.last %}, {% endif %}{% endfor %}"{% endif %}{% if reading_time %},
  "wordCount": "{{ til.body|wordcount }}",
  "timeRequired": "PT{{ reading_time }}M"{% endif %}
}
</script>
{% endblock %}

{% block content %}

  <article class="til-detail">
  <header>
  <span class="til-badge">Today I Learned</span>
  <h1 class="synth-wave-header">{{ til.title }}</h1>
  <div class="post-meta">
  <time datetime="{{ til.created|date:'Y-m-d' }}">{{ til.created|date:"F j, Y" }}</time>

  {% if til.author %}

    by {{ til.author.get_full_name|default:til.author.username }}

  {% endif %}


  {% if reading_time %}

    <span class="reading-time">{{ reading_time }} min read</span>

  {% endif %}

  </div>
  </header>

  {% if til.get_image_url %}
  <figure class="post-image">
    <img src="{{ til.get_image_url }}" alt="{{ til.image_alt_text }}" />
    {% if til.image_caption_html %}
    <figcaption>{{ til.image_caption_html }}</figcaption>
    {% endif %}
  </figure>
  {% endif %}

  <div class="til-content">
  {{ til.body_rendered }}
  </div>


  {% if til.tags.exists %}

    <div class="til-tags">
    <h3>Tags:</h3>

    {% for tag in til.tags.all %}

      <a href="
      {% url 'til:tag' tag.slug %}
      " class="tag">{{ tag.name }}</a>

    {% endfor %}

    </div>

  {% endif %}

  </article>

{% endblock %}
